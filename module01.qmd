# Module 1: Acquisition of Near-Cloud-Free Satellite Imagery {#sec-module-1}

# Module Overview {.unnumbered}

The output of this module is high-quality, near-cloud-free satellite imagery, which is essential for producing accurate and reliable land use and land cover (LULC) datasets. This module focuses on acquiring satellite imagery that has been pre-processed and corrected, including procedures such as cloud masking and shadow removal.

# Input {.unnumbered}

**User's Input**

1.  Area of interest (AOI).
2.  Selection of single or multiple time-series imagery.
3.  Target map year (YYYY).
4.  Desired spatial resolution (meters).
5.  Maximum allowable cloud cover (%).

**Automatic System Input**

1.  Raw satellite imagery.
2.  Administrative boundaries.

# Output {.unnumbered}

1.  Selected AOI.
2.  Near-cloud-free satellite imagery.

# Process {.unnumbered}

```{mermaid}

flowchart TD

A([<a href="#sec-selection-of-aoi">Selection of AOI</a>])
B([<a href="#sec-aoi-from-administrative-boundaries">AOI from Administrative Boundaries</a>])
C([<a href="#sec-aoi-from-a-shapefile">AOI from a Shapefile</a>])
D([<a href="#sec-aoi-from-on-screen-digitizing">AOI from On-Screen Digitizing</a>])
E([<a href="#sec-input-spatial-image-parameters">Input Spatial Image Parameters</a>])
F([<a href="#sec-satellite-imagery-cannot-be-found">Satellite Imagery Not Found</a>])
G([<a href="#sec-satellite-imagery-post-processing">Satellite Imagery Post-Processing: Visualization & Saving Data</a>])

%% Flow connections
A --> B
A --> C
A --> D

B --> E
C --> E
D --> E

E -->|Imagery available| G
E -->|Imagery not available| F

F --> E

```

## Selection of AOI {#sec-selection-of-aoi}

::: callout-note
@sec-aoi-from-administrative-boundaries, @sec-aoi-from-shapefile, @sec-aoi-from-on-screen-digitizing are options.
:::

### AOI from Administrative Boundaries {#sec-aoi-from-administrative-boundaries}

**Front-end**

The user selects an administration boundary.

**Back-end**

The system queries the FAO Global Administrative Unit Layers (GAUL) 2015 datasets, which provide standardized information on country and sub-national boundaries, and saves the AOI as a variable.

### AOI from Shapefile {#sec-aoi-from-shapefile}

**Front-end**

The user can upload their `.SHP` file.

**Back-end**

The system supports shapefile in `.ZIP` format.

### AOI from On-Screen Digitizing {#sec-aoi-from-on-screen-digitizing}

**Front-end**

The user is presented with an interactive on-screen digitization process.

**Back-end**

??

## Selecting and Preparing Satellite Imagery

### Input Spatial Image Parameters {#sec-input-spatial-image-parameters}

**Front-end**

The user is prompted to fill in these parameters:

1.  Spatial resolution (meters): Specify the desired spatial resolution.\
2.  Input year: Choose either single-date or multi-year imagery.\
3.  Maximum cloud cover: Set a preferred cloud cover threshold, or use the default value of 30%.

**Back-end**

1.  The system uses multi-temporal Landsat 8 and Landsat 9 surface reflectance imagery as a default data source.\
2.  The system retrieves images that match user’s selected criteria, including spatial resolution, year, and cloud cover. For single-year imagery, the system selects Landsat images from December 31st of year T or the lowest cloud cover scene available that year. For multi-year imagery, the system retrieves the lowest cloud cover image for each year in the specified range.\
3.  The system crops and mosaics the selected satellite imagery to match the user’s AOI.\
4.  The system performs cloud masking in three steps: cloud detection, mask refinement, and image compositing. The QA_PIXEL band encodes pixel conditions using specific bit flags. `Bitwise AND` operations are applied to isolate these conditions, focusing on clouds (bit 4, value 16) and cloud shadows (bit 3, value 8). Pixels matching these flags are excluded to produce a cleaner, near cloud-free image.\
5.  The system evaluates whether the retrieved imagery meets the required spatial resolution, input year, and cloud cover thresholds.\
6.  If there is no satellite imagery available for the user's input parameters, proceed to @sec-satellite-imagery-cannot-be-found

### Satellite Imagery Not Found Based on User’s Parameters {#sec-satellite-imagery-cannot-be-found}

**Front-end**

The user is prompted to adjust parameters, such as increasing the cloud cover limit, selecting a different time period, or choosing a different spatial resolution.

**Back-end**

1.  Before prompting the user to insert new parameters, the system searches imagery from year T to T-2 to replace cloudy areas via image compositing.\
2.  If requirements remain unmet, @sec-input-spatial-image-parameters will re-run based on new user parameters.

## Satellite Imagery Post-Processing

### Visualization and Saving Data

**Front-end**

1.  The user can visualize the near cloud-free imagery within the web portal and download it as a `.TIF` file.\
2.  A summary report containing the metadata is provided as a `.TXT` file.

**Back-end**

1.  The system produces near-cloud-free Landsat imagery for the defined AOI, saves it as a variable, and visualizes the processed datasets.\
2.  A summary report of metadata is generated, including acquisition details, cloud cover statistics, and a summary of processing steps applied.
